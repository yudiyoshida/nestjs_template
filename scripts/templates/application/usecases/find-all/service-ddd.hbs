import { Inject, Injectable } from '@nestjs/common';
import { TOKENS } from 'src/core/di/token';
import { IPagination, Pagination } from 'src/shared/value-objects/pagination/pagination.vo';
import { {{moduleNamePascal}}Dto } from '../../dtos/{{moduleName}}.dto';
import type { I{{moduleNamePascal}}Dao } from '../../persistence/dao/{{moduleName}}-dao.interface';
import { FindAll{{moduleNamePascal}}QueryDto } from './dtos/find-all-{{moduleName}}.dto';

@Injectable()
export class FindAll{{moduleNamePascal}} {
  constructor(
    @Inject(TOKENS.{{moduleNamePascal}}Dao) private readonly {{moduleNameCamel}}Dao: I{{moduleNamePascal}}Dao,
  ) {}

  public async execute(queries: FindAll{{moduleNamePascal}}QueryDto): Promise<IPagination<{{moduleNamePascal}}Dto>> {
    const [result, total] = await this.{{moduleNameCamel}}Dao.findAll(queries);
    return new Pagination(result, total, queries.page, queries.size).getDto();
  }
}
