import { Test } from '@nestjs/testing';
import { {{moduleNamePascal}}PersistenceModule } from 'src/app/{{moduleName}}/application/persistence/{{moduleName}}-persistence.module';
import { ConfigModule } from 'src/core/config/config.module';
import { PrismaService } from 'src/infra/database/prisma/prisma.service';
import { {{moduleNamePascal}}RepositoryAdapterPrisma } from './{{moduleName}}-prisma.repository';

describe('{{moduleNamePascal}}RepositoryAdapterPrisma', () => {
  let sut: {{moduleNamePascal}}RepositoryAdapterPrisma;
  let prisma: PrismaService;

  beforeAll(async() => {
    const module = await Test.createTestingModule({
      imports: [
        {{moduleNamePascal}}PersistenceModule,
        ConfigModule,
      ],
      providers: [
        {{moduleNamePascal}}RepositoryAdapterPrisma,
      ],
    }).compile();

    sut = module.get({{moduleNamePascal}}RepositoryAdapterPrisma);
    prisma = module.get(PrismaService);
  });

  beforeEach(async() => {
    await prisma.{{moduleNameCamel}}.deleteMany();
  });

  afterAll(async() => {
    await prisma.{{moduleNameCamel}}.deleteMany();
    await prisma.$disconnect();
  });

  it('should be defined', () => {
    expect(sut).toBeDefined();
  });
});
